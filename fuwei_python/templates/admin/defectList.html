<!DOCTYPE html>
<html>

<style>
    .input-box{
        width:95%;
        padding:5px;
        margin-top:10px;
        height:40px
    }

</style>
    {% include "admin/base.html" %}
    <body class="skin-blue">
        <!-- header logo: style can be found in header.less -->
        {% include "admin/header.html" %}

        <div class="wrapper row-offcanvas row-offcanvas-left">
            <aside class="left-side sidebar-offcanvas">
                <!-- sidebar: style can be found in sidebar.less -->
                <section class="sidebar">
                    <!-- Sidebar user panel -->
                    <!-- search form -->
                    <!-- /.search form -->
                    <!-- sidebar menu: : style can be found in sidebar.less -->
                       {% include "admin/menu.html" %}
                </section>
                <!-- /.sidebar -->
            </aside>

            <!-- Right side column. Contains the navbar and content of the page -->
            <aside class="right-side">
                <!-- Content Header (Page header) -->
                <section class="content-header">
                    <h1>
                        it缺陷流管理
                        <small>Preview page</small>
                    </h1>
                    <ol class="breadcrumb">
                        <li><a href="#"><i class="fa fa-dashboard"></i> 登录页</a></li>
                        <li class="active">用户缺陷列表</li>
                    </ol>
                </section>
                <section class="content">
                    <div style="float: left;width: 100%;margin-bottom: 5px">
                        <div style="float: left;width: 15%;margin-left: 10px">
                            <input id="search" name="search" class="form-control" placeholder="缺陷单号/标题" value="{{search}}">
                        </div>
                        <div style="float: left;width: 3%; margin-left: 5px">
                            <button id="sub" type="button" class="btn btn-primary">搜索</button>
                        </div>
                    </div>
                </section>

                <section class="content">
                    <table id="example1" class="table table-bordered table-striped">
                        <thead>
                        <tr>
                            <th>缺陷单号</th>
                            <th>所属产品</th>
                            <th>缺陷标题</th>
                            <th>缺陷状态</th>
                            <th>流程阶段</th>
                            <th>处理人</th>
                            <th>缺陷等级</th>
                            <th>是否可重现</th>
                            <th>已创建时间</th>
                        </tr>
                        </thead>
                        <tbody id="tb">
                        {% for defect in defects %}
                            <tr>
                                <td>
                                    <a style="color: blue"  target="_blank" href="/admin/defect_detail?defect_id={{ defect.id }}">{{ defect.defect_number }} </a>
                                </td>
                                <td title="{{ defect.product_or_version }}"  style="white-space: nowrap;overflow: hidden;text-overflow:ellipsis">
                                    {{ defect.product_or_version }}
                                </td>
                                <td title="{{ defect.title }}" style="white-space: nowrap;overflow: hidden;text-overflow:ellipsis;width: 260px">{{ defect.title }}</td>
                                <td title="{{ defect.status_name }}" style="white-space: nowrap;overflow: hidden;text-overflow:ellipsis;width: 80px">{{ defect.status_name }}</td>
                                <td title="{{ defect.stage_name }}">{{ defect.stage_name }}</td>
                                <td>{{ defect.current_stage.assignee.real_name }}</td>
                                <td>
                                    <span class="status-tag {{defect.severity_class }}">
                                    {{ defect.severity }}
                                    </span>
                                </td>
                                <td>{{defect.defect_reproducibility}}</td>
                                <td>{{defect.days_passed}}天</td>
                            </tr>
                        {% endfor %}
                       </tbody>
                    </table>
                    <ul class="pagination pagination-sm no-margin pull-right">
                        {{ pagination.links }}
                    </ul>
                </section>
            </aside>
    </body>
</html>
<script src="{{ url_for('static', filename='admin/js/common.js')}}" type="text/javascript"></script>
<script>
    $(function () {
        $('#sub').click(function () {
            location.href = "/admin/defect_list?menu_id=14&search=" + $('#search').val();
        })
    })
</script>