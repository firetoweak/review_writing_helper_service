<!DOCTYPE html>
<html>

<style>
    .input-box{
        width:95%;
        padding:5px;
        margin-top:10px;
        height:40px
    }

</style>
    {% include "admin/base.html" %}
    <body class="skin-blue">
        <!-- header logo: style can be found in header.less -->
        {% include "admin/header.html" %}

        <div class="wrapper row-offcanvas row-offcanvas-left">
            <aside class="left-side sidebar-offcanvas">
                <!-- sidebar: style can be found in sidebar.less -->
                <section class="sidebar">
                    <!-- Sidebar user panel -->
                    <!-- search form -->
                    <!-- /.search form -->
                    <!-- sidebar menu: : style can be found in sidebar.less -->
                       {% include "admin/menu.html" %}
                </section>
                <!-- /.sidebar -->
            </aside>

            <!-- Right side column. Contains the navbar and content of the page -->
            <aside class="right-side">
                <!-- Content Header (Page header) -->
                <section class="content-header">
                    <h1>
                        手机用户管理
                        <small>Preview page</small>
                    </h1>
                    <ol class="breadcrumb">
                        <li><a href="#"><i class="fa fa-dashboard"></i> 登录页</a></li>
                        <li class="active">手机用户列表</li>
                    </ol>
                </section>
                <section class="content">
                    <div style="float: left;width: 100%;margin-bottom: 5px">
                        <div style="float: left;width: 5%;margin-top: 5px"> <a  id="delete_all" url="/admin/del_mobile_users" style="cursor: pointer">删除选中</a></div>
                        <div style="float: left;width: 15%;margin-left: 10px">
                            <input id="mobile" name="mobile" class="form-control" placeholder="手机号/真实姓名" value="{{mobile}}">
                        </div>
                        <div style="float: left;width: 3%; margin-left: 5px">
                            <button id="sub" type="button" class="btn btn-primary">搜索</button>
                        </div>
                        <div style="float: left;width: 10%; margin-left: 5px">
                            <button id="add_show" type="button" class="btn btn-danger">新增</button>
                        </div>
                    </div>
                </section>

                <section class="content">
                    <table id="example1" class="table table-bordered table-striped">
                        <thead>
                        <tr>
                            <th style="width: 3%">
                                <div class="checkbox">
                                    <label>
                                        <input type="checkbox"    class="icheck-me">
                                    </label>
                                </div>
                            </th>
                            <th>用户id</th>
                            <th>真实姓名</th>
                            <th>手机号</th>
                            <th>公司名</th>
                            <th>职位</th>
                            <th>行业场景</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody id="tb">
                        {% for item in items %}
                            <tr>
                                <td>
                                    <div class="form-check">
                                        <input class="form-check-input row-checkbox"  value="{{item.user_id}}" type="checkbox"  name="id">
                                    </div>
                                </td>
                                <td>{{item.user_id}}</td>
                                <td>{{item.real_name}}</td>
                                <td>{{item.mobile}}</td>
                                <td>{{item.company_name}}</td>
                                <td>{{item.position}}</td>
                                <td>{{item.sense}}</td>
                                <td><a href="/admin/mobile_user_edit?user_id={{item.user_id}}">编辑</a>|
                                    <a style="cursor: pointer"  onclick="confirm('你确认要删除吗？')?location.href='/admin/del_one_user?user_id={{item.user_id}}':''">删除
                                </td>
                            </tr>
                        {% endfor %}
                       </tbody>
                    </table>
                    <ul class="pagination pagination-sm no-margin pull-right">
                        {{ pagination.links }}
                    </ul>
                </section>
            </aside>
    </body>
</html>

<script src="{{ url_for('static', filename='admin/js/common.js')}}" type="text/javascript"></script>
<script>
    $(function () {
        $('#sub').click(function () {
            location.href = "/admin/mobile_users?mobile=" + $('#mobile').val();
        })
    })
    $('#add_show').click(function () {
        let html = `
        <form id ="user_profile">
        <div class="input-box">
            <div style="width: 20%;text-align: right;float: left;padding: 5px">
                用户名：
            </div>
            <div style="width: 80%;float: left">
                   <input type="text" id="mobile" name="mobile" class="form-control" placeholder="用户名：11位手机号码"  maxlength="11"/>
            </div>
        </div>
        <div class="input-box">
            <div style="width: 20%;text-align: right;float: left;padding: 5px">
                真实姓名：
            </div>
            <div style="width: 80%;float: left">
                   <input type="text" id="real_name" name="real_name" class="form-control" placeholder="真实姓名"  maxlength="11"/>
            </div>
        </div>
        <div class="input-box">
            <div style="width: 20%;text-align: right;float: left;padding: 5px">
                密码：
            </div>
            <div style="width: 80%;float: left">
                   <input type="password" id="password" name="password" class="form-control" placeholder="密码：至少6位"/>
            </div>
        </div>
        <div  class="input-box">
            <div style="width: 20%;text-align: right;float: left;padding: 5px">
                确认密码：
            </div>
            <div style="width: 80%;float: left">
                  <input type="password" id="password2" name="password2" class="form-control" placeholder="确认密码：至少6位"/>
            </div>
        </div>
        <div class="input-box">
            <div style="width: 20%;text-align: right;float: left;padding: 5px">
                公司名称：
            </div>
            <div style="width: 80%;float: left">
                   <input type="text" id="company_name" name="company_name" class="form-control" placeholder="公司名称"  maxlength="50"/>
            </div>
        </div>
        <div  class="input-box">
            <div style="width: 20%;text-align: right;float: left;padding: 5px">
                使用人数：
            </div>
            <div style="width: 80%;float: left">
                        <select id="employees_num" name="employees_num" class="form-control">
                            {% for e in allEmployeesNum %}
                            <option value="{{e}}">{{e}}</option>
                            {% endfor %}
                        </select>
            </div>
        </div>
         <div  class="input-box">
            <div style="width: 20%;text-align: right;float: left;padding: 5px">
                选择行业场景：
            </div>
            <div style="width: 80%;float: left">
                        <select id="sense" name="sense" class="form-control">

                            {% for s in allSense %}
                                <option value="{{s}}">{{s}}</option>
                            {% endfor %}
                        </select>
            </div>
        </div>
        <div  class="input-box">
            <div style="width: 20%;text-align: right;float: left;padding: 5px">
                选择行业场景：
            </div>
            <div style="width: 80%;float: left">
                        <select id="position" name="position" class="form-control">
                            {% for p in allPosition %}
                            <option value="{{p}}">{{p}}</option>
                            {% endfor %}
                        </select>
            </div>
        </div>
        </form>
        <div  class="input-box" style="text-align: right">
             <button id="add_do" type="button" class="btn btn-danger">确认新增</button>
        </div>
        `

        layer.open({
            type: 1, // page 层类型
            area: ['650px', '510px'],
            title: '添加新用户',
            shade: 0.6, // 遮罩透明度
            shadeClose: true, // 点击遮罩区域，关闭弹层
            maxmin: true, // 允许全屏最小化
            anim: 0, // 0-6 的动画形式，-1 不开启
            content: html
        });

        $('#add_do').click(function () {
            var formData = {};
            $('#user_profile').serializeArray().forEach(function(item) {
                formData[item.name] = item.value;
            });

            $.ajax({
                type: "POST",
                url: "/admin/mobile_users?act=add",
                contentType: 'application/json',
                data: JSON.stringify(formData),
                async:false,
                success: function (data) {
                    if(data.code<0){
                        alert(data.msg)
                    }else{
                        location.reload()
                    }
                }
            })

        })
    })
</script>